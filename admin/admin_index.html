<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <title>Chavarak</title>

</head>
<body>

  

  <div class="navbar">
    <div class="menu">
      <img src="../images/logo.png" alt="Logo" >
      <a href="home.php" id="homeMenu">Home</a>

      <div class="dropdown">
        <a href="#" id="sectionMenu" >Section<i class='bx bx-chevron-down'></i></a>
        <div class="dropdown-content">
          <a href="spiral.php?S_ID=1">Spiral</a>
          <a href="fitting.php?S_ID=2">Fitting</a>
          <a href="hydrotest.php?S_ID=3">Hydrotest</a>
          <a href="blast.php?S_ID=4">Blast</a>
          <a href="pu.php?S_ID=5">PU</a>
          <a href="inner_Paint.php?S_ID=6">Inner Paint</a>
          <a href="outer_paint.php?S_ID=7">Outer Paint</a>
        </div>
      </div>

      <div class="dropdown">
        <a href="#" id="orderMenu">Order<i class='bx bx-chevron-down'></i></a>
        <div class="dropdown-content">
          <a href="customer.php">ข้อมูลลูกค้า</a>
          <a href="order.php">คำสั่งซื้อสินค้า</a>
        </div>
      </div>

      <a href="product_plan.php" id="productionPlanMenu">Production Plan</a>
      <a href="summary.php" id="summaryMenu">Summary</a>

      <div class="dropdown">
        <a href="#" id="stockMenu">Stock<i class='bx bx-chevron-down'></i></a>
        <div class="dropdown-content">
          <a href="stock.php">มีเจ้าของ</a>
          <a href="stock_no.php">ไม่มีเจ้าของ</a>
          <a href="raw_material.php">วัตถุดิบ</a>
          <a href="raw_disbursment.php">เบิกวัตถุดิบ</a>
        </div>
      </div>

      <a href="user_account.php" id="accountMenu">Account</a>

      <div class="dropdown">
        <a href="#" id="settingMenu">Setting<i class='bx bx-chevron-down'></i></a>
        <div class="dropdown-content">
          <a href="type.php">ประเภทและขนาดท่อ</a>
          <a href="product.php">ผลิตภัณฑ์</a>
          <a href="work_step.php">ลำดับการทำงาน</a>
          <a href="calculate.php">คำนวนยอดการผลิต</a>
          <a href="percentages.php">กำหนด % แสดงสถานะ</a>
          <a href="working_time.php">เวลาการทำงาน</a>
        </div>
      </div>

     
      <div class="dropdown">
        <a href="#" id="exportMenu">Export<i class='bx bx-chevron-down'></i></a>
        <div class="dropdown-content">
          <a href="export_actual.php">รายงานยอดการผลิต</a>
          <a href="export_order1.php">รายงานคำสั่งซื้อ</a>
          <a href="export_stock1.php">รายงานสินค้าคงคลังที่มีเจ้าของ</a>
          <a href="export_stock_No.php">รายงานสินค้าคงคลังที่ไม่มีเจ้าของ</a>
          <a href="export_material.php">รายงานวัตถุดิบ</a>
        </div>
      </div>
    
    </div>

    <div class="navbar-content">
      <a href="#" id="notification-icon"><i class='bx bx-bell'></i></a>
      <div class="profile-container">
          <a href="infoPerson.php">
              <img id="navbarProfileImage" src="https://cdn-icons-png.flaticon.com/512/149/149071.png" alt="Profile Picture" class="profile-image">
          </a>
      </div>
      <div class="bar-content">
          <button id="logoutButton" class="btn btn-outline-light">
              <i class="fa-solid fa-arrow-right-from-bracket"></i>
          </button>
      </div>
  </div>

    


</div>


  



  <div id="logoutModal" class="modal fade" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body">
          <p>คุณต้องการออกจากระบบใช่หรือไม่?</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" id="confirmLogout">ออกจากระบบ</button>
          <button class="btn btn-secondary" data-bs-dismiss="modal">ยกเลิก</button>
        </div>
      </div>
    </div>
  </div>

  <script>

    document.addEventListener("DOMContentLoaded", function() {
      const logoutButton = document.getElementById("logoutButton");
      const logoutModalElement = document.getElementById("logoutModal");
      const confirmLogoutButton = document.getElementById("confirmLogout");

      const logoutModal = new bootstrap.Modal(logoutModalElement);

      logoutButton.addEventListener("click", function() {
        logoutModal.show();
      });

      confirmLogoutButton.addEventListener("click", function() {
        logout();
      });

      function logout() {
        sessionStorage.removeItem('currentPage');
        localStorage.removeItem('currentUser');
        window.location.href = "/login.php";
      }
    });

    document.addEventListener("DOMContentLoaded", function() {
    const currentPath = window.location.pathname;
    
    function setActiveMenu(menuId) {
      document.getElementById(menuId).classList.add('active');
    }

    if (currentPath.includes("home.php")) {
      setActiveMenu("homeMenu");
    } else if (currentPath.includes("user_account.php")) {
      setActiveMenu("accountMenu");
    } else if (currentPath.includes("spiral.php")) {
      setActiveMenu("sectionMenu");
    } else if (currentPath.includes("fitting.php")) {
      setActiveMenu("sectionMenu");
    } else if (currentPath.includes("hydrotest.php")) {
      setActiveMenu("sectionMenu");
    } else if (currentPath.includes("blast.php")) {
      setActiveMenu("sectionMenu");
    } else if (currentPath.includes("pu.php")) {
      setActiveMenu("sectionMenu");
    } else if (currentPath.includes("inner_Paint.php")) {
      setActiveMenu("sectionMenu");
    } else if (currentPath.includes("outer_paint.php")) {
      setActiveMenu("sectionMenu");
    } else if (currentPath.includes("customer.php")) {
      setActiveMenu("orderMenu");
    } else if (currentPath.includes("order.php")) {
      setActiveMenu("orderMenu");
    } else if (currentPath.includes("product_plan.php")) {
      setActiveMenu("productionPlanMenu");
    } else if (currentPath.includes("summary.php")) {
      setActiveMenu("summaryMenu");
    } else if (currentPath.includes("stock.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("add_stock.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("edit_stock.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("raw_material.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("add_material.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("edit_material.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("supplier.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("stock_no.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("raw_disbursment.php")) {
      setActiveMenu("stockMenu");
    } else if (currentPath.includes("product.php")) {
      setActiveMenu("settingMenu");
    }else if (currentPath.includes("add_product.php")) {
      setActiveMenu("settingMenu");
    }else if (currentPath.includes("edit_product.php")) {
      setActiveMenu("settingMenu");
    }else if (currentPath.includes("percentages.php")) {
      setActiveMenu("settingMenu");
    }else if (currentPath.includes("type.php")) {
      setActiveMenu("settingMenu");
    }else if (currentPath.includes("calculate.php")) {
      setActiveMenu("settingMenu");
    }else if (currentPath.includes("work_step.php")) {
      setActiveMenu("settingMenu");
    }else if (currentPath.includes("working_time.php")) {
        setActiveMenu("settingMenu");
    }else if (currentPath.includes("export_actual.php")) {
      setActiveMenu("exportMenu");
    }else if (currentPath.includes("export_material.php")) {
      setActiveMenu("exportMenu");
    }else if (currentPath.includes("export_order1.php")) {
      setActiveMenu("exportMenu");
    }else if (currentPath.includes("export_stock1.php")) {
      setActiveMenu("exportMenu");
    }else if (currentPath.includes("export_stock_No.php")) {
      setActiveMenu("exportMenu");
    }
    
  });


document.addEventListener("DOMContentLoaded", function() {
    // ใช้ AJAX เพื่อดึงข้อมูลรูปโปรไฟล์
    fetch('get_profile_picture.php')
    .then(response => response.json())
    .then(data => {
        if (data.profilePicture) {
            // อัปเดตรูปโปรไฟล์ในแถบเมนู
            document.getElementById('navbarProfileImage').src = data.profilePicture;
        } else if (data.error) {
            console.error('Error:', data.error);
        }
    })
    .catch(error => console.error('Error fetching profile picture:', error));
});



function saveUserData(username) {
            localStorage.setItem('currentUser', username);
        }

        function loadUserData() {
            return localStorage.getItem('currentUser');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const currentUser = loadUserData();
            if (currentUser) {
                document.getElementById('username').textContent = currentUser;
            }
        });
    

  </script>
</body>
</html>

